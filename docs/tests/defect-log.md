# 房间对局模块缺陷跟踪表
文档版本：v0.1.0  
关联应用版本：ttg-chat v1.0.0  
最后更新：2026-02-08  
范围：仅“房间对局模块”

使用说明：
- 每个缺陷必须关联至少 1 条规则条目（[游戏规则总览](../../gamerules.md)）或用例（[测试用例](./test-cases.md)）。
- 每次修复合入后，在本表更新“状态/修复版本/验证结果”，并在 [修复与回归验证报告](./fix-verification.md) 留痕。

状态枚举：New / Triaged / In Progress / Fixed / Verified / Won’t Fix / Duplicate

严重度定义：
- P0：资金/数据泄露/对局无法继续/状态分叉/安全问题
- P1：核心流程失败（创建房间/开始对局/关键动作）
- P2：边界与体验缺陷（提示不清、弱网不友好、偶现问题）
- P3：文案/样式/非关键体验

---

## 缺陷列表（表格）
| ID | 场景描述 | 预期行为 | 实际结果 | 严重度 | 规则/用例关联 | 复现步骤 | 根因分类 | 状态 | 修复版本 | 验证结果 |
|---|---|---|---|---|---|---|---|---|---|---|
| BUG-001 | 德州顺子误判（4连也判顺子） | 非顺子不应判顺子 | A K Q J 9 被判顺子 | P0 | TC-TX-101 | 运行逻辑用例/脚本 | 实现错误 | Fixed | v1.0.0 | 已回归通过（见 fix_verification） |
| BUG-002 | A2345 顺子高张错误 | wheel 高张应为 5 | 高张返回 A 导致比较错误 | P0 | TC-TX-102 | 运行逻辑用例/脚本 | 实现错误 | Fixed | v1.0.0 | 已回归通过（见 fix_verification） |
| BUG-003 | 前端 Vite ws/http proxy 报错（ECONNREFUSED） | 开发环境代理稳定 | 后端仅监听 IPv6 导致代理连到 IPv4 失败 | P1 | TC-NET-001 | 启动前后端 dev 并观察 Vite 日志 | 环境/配置 | Fixed | v1.0.0 | 已改为代理到 https://[::1]:888 并验证前端 build 通过 |
| BUG-004 | 离开房间/销毁房间并发导致 DB Deadlock | 不应死锁，操作应最终成功 | ER_LOCK_DEADLOCK，leave_room 失败 | P1 | TC-ROOM-106/303 | E2E：对局结束后同时 leave_room + destroy | 并发/DB | Fixed | v1.0.0 | E2E 回归通过（见 fix_verification） |

---

## 缺陷管理流程（执行规范）
1. 记录：发现后立即补全“复现步骤 + 预期/实际 + 严重度 + 关联用例”
2. 归因：标记根因分类（规则缺陷/实现错误/资源问题/环境配置/第三方）
3. 修复：进入 In Progress 时必须指派到具体模块文件
4. 回归：每个 Fixed 缺陷至少跑一遍关联用例 + 一遍最小冒烟集
5. 关闭：只有 Verified 才算关闭；Won’t Fix 必须给出风险与替代方案
