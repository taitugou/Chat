# 项目总览

## 目录结构
- `frontend/`：Vite + Vue3 + Pinia + Vue Router（前端 SPA）
- `backend/`：Node.js（ESM）+ Express + Socket.IO（REST + 实时）
- `database/`：SQL 初始化与迁移脚本（项目根）
- `docs/`：产品/部署/对比文档（非源码梳理）

## 运行时形态（从入口代码反推）
- 后端主服务：REST API + Socket.IO + 前端静态资源托管
  - 入口：[server.js](file:///f:/C/backend/server.js#L1-L175)
- 后端管理服务：仅挂载 `/api/admin` 的独立服务
  - 入口：[admin-server.js](file:///f:/C/backend/admin-server.js)
- 前端：挂载前会尝试用 token 拉取用户信息，并初始化 Socket
  - 入口：[main.ts](file:///f:/C/frontend/src/main.ts#L1-L45)

## 核心数据流（高层）
- 登录/注册/游客登录 → 返回 JWT → 前端存 `localStorage(token)` → axios 自动注入 Bearer → 后端 `authenticate` 校验
  - 前端： [auth.ts](file:///f:/C/frontend/src/stores/auth.ts#L15-L163)，[api.ts](file:///f:/C/frontend/src/utils/api.ts#L1-L68)
  - 后端： [routes/auth.js](file:///f:/C/backend/routes/auth.js#L92-L463)，[auth.js](file:///f:/C/backend/middleware/auth.js#L6-L99)
- Socket：前端 `auth: { token }` 连接 → 后端 `socketAuth` 校验 → 各类事件在 handlers 中注册
  - 前端： [socket.ts](file:///f:/C/frontend/src/utils/socket.ts#L1-L125)
  - 后端： [socketAuth.js](file:///f:/C/backend/middleware/socketAuth.js#L1-L51)，[handlers.js](file:///f:/C/backend/socket/handlers.js)
- 数据库：后端启动时初始化连接池，并在启动阶段做字段/索引补齐
  - [connection.js](file:///f:/C/backend/database/connection.js#L6-L33)

## 进一步阅读
- 后端启动与路由挂载： [10-后端-服务入口与启动流程.md](file:///f:/C/yuanma/10-%E5%90%8E%E7%AB%AF-%E6%9C%8D%E5%8A%A1%E5%85%A5%E5%8F%A3%E4%B8%8E%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B.md)
- 鉴权与 Token： [11-后端-鉴权与Token.md](file:///f:/C/yuanma/11-%E5%90%8E%E7%AB%AF-%E9%89%B4%E6%9D%83%E4%B8%8EToken.md)
- Socket 事件地图： [13-后端-Socket.IO事件与在线状态.md](file:///f:/C/yuanma/13-%E5%90%8E%E7%AB%AF-Socket.IO%E4%BA%8B%E4%BB%B6%E4%B8%8E%E5%9C%A8%E7%BA%BF%E7%8A%B6%E6%80%81.md)

